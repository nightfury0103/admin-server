/*! For license information please see bitcoinjs.min.js.LICENSE.txt */
var base64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if("undefined"!=typeof window&&window)_window=window;else var _window={};var Crypto=_window.Crypto={},util=Crypto.util={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&util.rotl(t,8)|4278255360&util.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=util.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){if("function"==typeof btoa)return btoa(Binary.bytesToString(t));for(var e=[],r=0;r<t.length;r+=3)for(var n=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?e.push(base64map.charAt(n>>>6*(3-o)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){if("function"==typeof atob)return Binary.stringToBytes(atob(t));t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,n=0;r<t.length;n=++r%4)0!=n&&e.push((base64map.indexOf(t.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|base64map.indexOf(t.charAt(r))>>>6-2*n);return e}};Crypto.mode={};var UTF8=(charenc=Crypto.charenc={}).UTF8={stringToBytes:function(t){return Binary.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(Binary.bytesToString(t)))}},Binary=charenc.Binary={stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}},K=(util=(C=Crypto).util,UTF8=(charenc=C.charenc).UTF8,Binary=charenc.Binary,[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256=C.SHA256=function(t,e){var r=util.wordsToBytes(SHA256._sha256(t));return e&&e.asBytes?r:e&&e.asString?Binary.bytesToString(r):util.bytesToHex(r)};SHA256._sha256=function(t){t.constructor==String&&(t=UTF8.stringToBytes(t));var e,r,n,o,s,u,a,h,g,l=util.bytesToWords(t),y=8*t.length,v=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],B=[];l[y>>5]|=128<<24-y%32,l[15+(y+64>>9<<4)]=y;for(var m=0;m<l.length;m+=16){e=v[0],r=v[1],n=v[2],o=v[3],s=v[4],u=v[5],a=v[6],h=v[7];for(var I=0;I<64;I++){if(I<16)B[I]=l[I+m];else{var T=B[I-15],_=B[I-2],O=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,P=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;B[I]=O+(B[I-7]>>>0)+P+(B[I-16]>>>0)}var S=e&r^e&n^r&n,E=(e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22);g=(h>>>0)+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&a)+K[I]+(B[I]>>>0),h=a,a=u,u=s,s=o+g,o=n,n=r,r=e,e=g+(E+S)}v[0]+=e,v[1]+=r,v[2]+=n,v[3]+=o,v[4]+=s,v[5]+=u,v[6]+=a,v[7]+=h}return v},SHA256._blocksize=16,function(){var t=Crypto,e=t.util,r=t.charenc,n=r.UTF8,o=r.Binary,s=t.SHA1=function(t,r){var n=e.wordsToBytes(s._sha1(t));return r&&r.asBytes?n:r&&r.asString?o.bytesToString(n):e.bytesToHex(n)};s._sha1=function(t){t.constructor==String&&(t=n.stringToBytes(t));var r=e.bytesToWords(t),o=8*t.length,s=[],u=1732584193,a=-271733879,h=-1732584194,g=271733878,l=-1009589776;r[o>>5]|=128<<24-o%32,r[15+(o+64>>>9<<4)]=o;for(var y=0;y<r.length;y+=16){for(var v=u,B=a,m=h,I=g,T=l,_=0;_<80;_++){if(_<16)s[_]=r[y+_];else{var O=s[_-3]^s[_-8]^s[_-14]^s[_-16];s[_]=O<<1|O>>>31}var P=(u<<5|u>>>27)+l+(s[_]>>>0)+(_<20?1518500249+(a&h|~a&g):_<40?1859775393+(a^h^g):_<60?(a&h|a&g|h&g)-1894007588:(a^h^g)-899497514);l=g,g=h,h=a<<30|a>>>2,a=u,u=P}u+=v,a+=B,h+=m,g+=I,l+=T}return[u,a,h,g,l]},s._blocksize=16,s._digestsize=20}();var C,charenc;util=(C=Crypto).util,UTF8=(charenc=C.charenc).UTF8,Binary=charenc.Binary;util.bytesToLWords=function(t){for(var e=Array(t.length>>2),r=0;r<e.length;r++)e[r]=0;for(r=0;r<8*t.length;r+=8)e[r>>5]|=(255&t[r/8])<<r%32;return e},util.lWordsToBytes=function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>5]>>>r%32&255);return e};var RIPEMD160=C.RIPEMD160=function(t,e){var r=util.lWordsToBytes(RIPEMD160._rmd160(t));return e&&e.asBytes?r:e&&e.asString?Binary.bytesToString(r):util.bytesToHex(r)};function rmd160_f(t,e,r,n){return 0<=t&&t<=15?e^r^n:16<=t&&t<=31?e&r|~e&n:32<=t&&t<=47?(e|~r)^n:48<=t&&t<=63?e&n|r&~n:64<=t&&t<=79?e^(r|~n):"rmd160_f: j out of range"}function rmd160_K1(t){return 0<=t&&t<=15?0:16<=t&&t<=31?1518500249:32<=t&&t<=47?1859775393:48<=t&&t<=63?2400959708:64<=t&&t<=79?2840853838:"rmd160_K1: j out of range"}function rmd160_K2(t){return 0<=t&&t<=15?1352829926:16<=t&&t<=31?1548603684:32<=t&&t<=47?1836072691:48<=t&&t<=63?2053994217:64<=t&&t<=79?0:"rmd160_K2: j out of range"}RIPEMD160._rmd160=function(t){t.constructor==String&&(t=UTF8.stringToBytes(t));var e=util.bytesToLWords(t),r=8*t.length;e[r>>5]|=128<<r%32,e[14+(r+64>>>9<<4)]=r;for(var n=1732584193,o=4023233417,s=2562383102,u=271733878,a=3285377520,h=0;h<e.length;h+=16){for(var g,l=n,y=o,v=s,B=u,m=a,I=n,T=o,_=s,O=u,P=a,S=0;S<=79;++S)g=safe_add(l,rmd160_f(S,y,v,B)),g=safe_add(g,e[h+rmd160_r1[S]]),g=safe_add(g,rmd160_K1(S)),g=safe_add(bit_rol(g,rmd160_s1[S]),m),l=m,m=B,B=bit_rol(v,10),v=y,y=g,g=safe_add(I,rmd160_f(79-S,T,_,O)),g=safe_add(g,e[h+rmd160_r2[S]]),g=safe_add(g,rmd160_K2(S)),g=safe_add(bit_rol(g,rmd160_s2[S]),P),I=P,P=O,O=bit_rol(_,10),_=T,T=g;g=safe_add(o,safe_add(v,O)),o=safe_add(s,safe_add(B,P)),s=safe_add(u,safe_add(m,I)),u=safe_add(a,safe_add(l,T)),a=safe_add(n,safe_add(y,_)),n=g}return[n,o,s,u,a]};var dbits,rmd160_r1=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rmd160_r2=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],rmd160_s1=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],rmd160_s2=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function safe_add(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function bit_rol(t,e){return t<<e|t>>>32-e}function ECFieldElementFp(t,e){this.x=e,this.q=t}function feFpEquals(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(t){return new ECFieldElementFp(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function feFpSubtract(t){return new ECFieldElementFp(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function feFpMultiply(t){return new ECFieldElementFp(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(t){return new ECFieldElementFp(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}function ECPointFp(t,e,r,n){this.curve=t,this.x=e,this.y=r,this.z=null==n?BigInteger.ONE:n,this.zinv=null}function pointFpGetX(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO))}function pointFpIsInfinity(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),r=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(r))return BigInteger.ZERO.equals(e)?this.twice():this.curve.getInfinity();var n=new BigInteger("3"),o=this.x.toBigInteger(),s=this.y.toBigInteger(),u=(t.x.toBigInteger(),t.y.toBigInteger(),r.square()),a=u.multiply(r),h=o.multiply(u),g=e.square().multiply(this.z),l=g.subtract(h.shiftLeft(1)).multiply(t.z).subtract(a).multiply(r).mod(this.curve.q),y=h.multiply(n).multiply(e).subtract(s.multiply(a)).subtract(g.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),v=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(y),v)}function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new BigInteger("3"),e=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),o=n.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),u=e.square().multiply(t);BigInteger.ZERO.equals(s)||(u=u.add(this.z.square().multiply(s)));var a=(u=u.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(n).mod(this.curve.q),h=u.multiply(t).multiply(e).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(u.square().multiply(u)).mod(this.curve.q),g=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),g)}function pointFpMultiply(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,r=t,n=r.multiply(new BigInteger("3")),o=this.negate(),s=this;for(e=n.bitLength()-2;e>0;--e){s=s.twice();var u=n.testBit(e);u!=r.testBit(e)&&(s=s.add(u?this:o))}return s}function pointFpMultiplyTwo(t,e,r){var n;n=t.bitLength()>r.bitLength()?t.bitLength()-1:r.bitLength()-1;for(var o=this.curve.getInfinity(),s=this.add(e);n>=0;)o=o.twice(),t.testBit(n)?o=r.testBit(n)?o.add(s):o.add(this):r.testBit(n)&&(o=o.add(e)),--n;return o}function ECCurveFp(t,e,r){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(r),this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(t){return new ECFieldElementFp(this.q,t)}function curveFpDecodePointHex(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;default:return null;case 4:case 6:case 7:var e=(t.length-2)/2,r=t.substr(2,e),n=t.substr(e+2,e);return new ECPointFp(this,this.fromBigInteger(new BigInteger(r,16)),this.fromBigInteger(new BigInteger(n,16)))}}!function(t){var e=t.pad={};function c(t,e){var r=4*t._blocksize;return r-e.length%r}var d=function(t,e,r,n){var o=e.pop();if(0==o)throw new Error("Invalid zero-length padding specified for "+r+". Wrong cipher specification or key used?");if(o>4*t._blocksize)throw new Error("Invalid padding length of "+o+" specified for "+r+". Wrong cipher specification or key used?");for(var s=1;s<o;s++){var u=e.pop();if(null!=n&&n!=u)throw new Error("Invalid padding byte of 0x"+u.toString(16)+" specified for "+r+". Wrong cipher specification or key used?")}};e.NoPadding={pad:function(t,e){},unpad:function(t,e){}},e.ZeroPadding={pad:function(t,e){var r=4*t._blocksize,n=e.length%r;if(0!=n)for(n=r-n;n>0;n--)e.push(0)},unpad:function(t,e){for(;0==e[e.length-1];)e.pop()}},e.iso7816={pad:function(t,e){var r=c(t,e);for(e.push(128);r>1;r--)e.push(0)},unpad:function(t,e){var r;for(r=4*t._blocksize;r>0;r--){var n=e.pop();if(128==n)return;if(0!=n)throw new Error("ISO-7816 padding byte must be 0, not 0x"+n.toString(16)+". Wrong cipher specification or key used?")}throw new Error("ISO-7816 padded beyond cipher block size. Wrong cipher specification or key used?")}},e.ansix923={pad:function(t,e){for(var r=c(t,e),n=1;n<r;n++)e.push(0);e.push(r)},unpad:function(t,e){d(t,e,"ANSI X.923",0)}},e.iso10126={pad:function(t,e){for(var r=c(t,e),n=1;n<r;n++)e.push(Math.floor(256*Math.random()));e.push(r)},unpad:function(t,e){d(t,e,"ISO 10126",void 0)}},e.pkcs7={pad:function(t,e){for(var r=c(t,e),n=0;n<r;n++)e.push(r)},unpad:function(t,e){d(t,e,"PKCS 7",e[e.length-1])}};var r=t.mode={},n=r.Mode=function(t){t&&(this._padding=t)};n.prototype={encrypt:function(t,e,r){this._padding.pad(t,e),this._doEncrypt(t,e,r)},decrypt:function(t,e,r){this._doDecrypt(t,e,r),this._padding.unpad(t,e)},_padding:e.iso7816};var o=r.ECB=function(){n.apply(this,arguments)},s=o.prototype=new n;s._doEncrypt=function(t,e,r){for(var n=4*t._blocksize,o=0;o<e.length;o+=n)t._encryptblock(e,o)},s._doDecrypt=function(t,e,r){for(var n=4*t._blocksize,o=0;o<e.length;o+=n)t._decryptblock(e,o)},s.fixOptions=function(t){t.iv=[]};var u=r.CBC=function(){n.apply(this,arguments)},a=u.prototype=new n;a._doEncrypt=function(t,e,r){for(var n=4*t._blocksize,o=0;o<e.length;o+=n){if(0==o)for(var s=0;s<n;s++)e[s]^=r[s];else for(s=0;s<n;s++)e[o+s]^=e[o+s-n];t._encryptblock(e,o)}},a._doDecrypt=function(t,e,r){for(var n=4*t._blocksize,o=r,s=0;s<e.length;s+=n){var u=e.slice(s,s+n);t._decryptblock(e,s);for(var a=0;a<n;a++)e[s+a]^=o[a];o=u}};var h=r.CFB=function(){n.apply(this,arguments)},g=h.prototype=new n;g._padding=e.NoPadding,g._doEncrypt=function(t,e,r){for(var n=4*t._blocksize,o=r.slice(0),s=0;s<e.length;s++){var u=s%n;0==u&&t._encryptblock(o,0),e[s]^=o[u],o[u]=e[s]}},g._doDecrypt=function(t,e,r){for(var n=4*t._blocksize,o=r.slice(0),s=0;s<e.length;s++){var u=s%n;0==u&&t._encryptblock(o,0);var a=e[s];e[s]^=o[u],o[u]=a}};var l=r.OFB=function(){n.apply(this,arguments)},y=l.prototype=new n;y._padding=e.NoPadding,y._doEncrypt=function(t,e,r){for(var n=4*t._blocksize,o=r.slice(0),s=0;s<e.length;s++)s%n==0&&t._encryptblock(o,0),e[s]^=o[s%n]},y._doDecrypt=y._doEncrypt;var v=r.CTR=function(){n.apply(this,arguments)},B=v.prototype=new n;B._padding=e.NoPadding,B._doEncrypt=function(t,e,r){for(var n=4*t._blocksize,o=r.slice(0),s=0;s<e.length;){var u=o.slice(0);t._encryptblock(u,0);for(var a=0;s<e.length&&a<n;a++,s++)e[s]^=u[a];256==++o[n-1]&&(o[n-1]=0,256==++o[n-2]&&(o[n-2]=0,256==++o[n-3]&&(o[n-3]=0,++o[n-4])))}},B._doDecrypt=B._doEncrypt}(Crypto),function(){var t=Crypto,e=t.util,r=t.charenc,n=r.UTF8,o=r.Binary;t.HMAC=function(t,r,s,u){r.constructor==String&&(r=n.stringToBytes(r)),s.constructor==String&&(s=n.stringToBytes(s)),s.length>4*t._blocksize&&(s=t(s,{asBytes:!0}));for(var a=s.slice(0),h=s.slice(0),g=0;g<4*t._blocksize;g++)a[g]^=92,h[g]^=54;var l=t(a.concat(t(h.concat(r),{asBytes:!0})),{asBytes:!0});return u&&u.asBytes?l:u&&u.asString?o.bytesToString(l):e.bytesToHex(l)}}(),function(){var t=Crypto,e=t.util,r=t.charenc,n=r.UTF8,o=r.Binary;t.PBKDF2=function(r,s,u,a){r.constructor==String&&(r=n.stringToBytes(r)),s.constructor==String&&(s=n.stringToBytes(s));var h=a&&a.hasher||t.SHA1,g=a&&a.iterations||1;function p(e,r){return t.HMAC(h,r,e,{asBytes:!0})}for(var l=[],y=1;l.length<u;){for(var v=p(r,s.concat(e.wordsToBytes([y]))),B=v,m=1;m<g;m++){B=p(r,B);for(var I=0;I<v.length;I++)v[I]^=B[I]}l=l.concat(v),y++}return l.length=u,a&&a.asBytes?l:a&&a.asString?o.bytesToString(l):e.bytesToHex(l)}}(),function(){for(var t=Crypto,e=t.util,r=t.charenc.UTF8,n=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],o=[],s=0;s<256;s++)o[n[s]]=s;var u=[],a=[],h=[],g=[],l=[],y=[];function f(t,e){for(var r=0,n=0;n<8;n++){1&e&&(r^=t);var o=128&t;t=t<<1&255,o&&(t^=27),e>>>=1}return r}for(s=0;s<256;s++)u[s]=f(s,2),a[s]=f(s,3),h[s]=f(s,9),g[s]=f(s,11),l[s]=f(s,13),y[s]=f(s,14);var v,B,m,I=[0,1,2,4,8,16,32,64,128,27,54],T=[[],[],[],[]],_=t.AES={encrypt:function(n,o,s){var u=(s=s||{}).mode||new t.mode.OFB;u.fixOptions&&u.fixOptions(s);var a=n.constructor==String?r.stringToBytes(n):n,h=s.iv||e.randomBytes(4*_._blocksize),g=o.constructor==String?t.PBKDF2(o,h,32,{asBytes:!0,iterations:s.iterations}):o;return _._init(g),u.encrypt(_,a,h),a=s.iv?a:h.concat(a),s&&s.asBytes?a:e.bytesToBase64(a)},decrypt:function(n,o,s){var u=(s=s||{}).mode||new t.mode.OFB;u.fixOptions&&u.fixOptions(s);var a=n.constructor==String?e.base64ToBytes(n):n,h=s.iv||a.splice(0,4*_._blocksize),g=o.constructor==String?t.PBKDF2(o,h,32,{asBytes:!0,iterations:s.iterations}):o;return _._init(g),u.decrypt(_,a,h),s&&s.asBytes?a:r.bytesToString(a)},_blocksize:4,_encryptblock:function(t,e){for(var r=0;r<_._blocksize;r++)for(var o=0;o<4;o++)T[r][o]=t[e+4*o+r];for(r=0;r<4;r++)for(o=0;o<4;o++)T[r][o]^=m[o][r];for(var s=1;s<B;s++){for(r=0;r<4;r++)for(o=0;o<4;o++)T[r][o]=n[T[r][o]];T[1].push(T[1].shift()),T[2].push(T[2].shift()),T[2].push(T[2].shift()),T[3].unshift(T[3].pop());for(o=0;o<4;o++){var h=T[0][o],g=T[1][o],l=T[2][o],y=T[3][o];T[0][o]=u[h]^a[g]^l^y,T[1][o]=h^u[g]^a[l]^y,T[2][o]=h^g^u[l]^a[y],T[3][o]=a[h]^g^l^u[y]}for(r=0;r<4;r++)for(o=0;o<4;o++)T[r][o]^=m[4*s+o][r]}for(r=0;r<4;r++)for(o=0;o<4;o++)T[r][o]=n[T[r][o]];T[1].push(T[1].shift()),T[2].push(T[2].shift()),T[2].push(T[2].shift()),T[3].unshift(T[3].pop());for(r=0;r<4;r++)for(o=0;o<4;o++)T[r][o]^=m[4*B+o][r];for(r=0;r<_._blocksize;r++)for(o=0;o<4;o++)t[e+4*o+r]=T[r][o]},_decryptblock:function(t,e){for(var r=0;r<_._blocksize;r++)for(var n=0;n<4;n++)T[r][n]=t[e+4*n+r];for(r=0;r<4;r++)for(n=0;n<4;n++)T[r][n]^=m[4*B+n][r];for(var s=1;s<B;s++){T[1].unshift(T[1].pop()),T[2].push(T[2].shift()),T[2].push(T[2].shift()),T[3].push(T[3].shift());for(r=0;r<4;r++)for(n=0;n<4;n++)T[r][n]=o[T[r][n]];for(r=0;r<4;r++)for(n=0;n<4;n++)T[r][n]^=m[4*(B-s)+n][r];for(n=0;n<4;n++){var u=T[0][n],a=T[1][n],v=T[2][n],I=T[3][n];T[0][n]=y[u]^g[a]^l[v]^h[I],T[1][n]=h[u]^y[a]^g[v]^l[I],T[2][n]=l[u]^h[a]^y[v]^g[I],T[3][n]=g[u]^l[a]^h[v]^y[I]}}T[1].unshift(T[1].pop()),T[2].push(T[2].shift()),T[2].push(T[2].shift()),T[3].push(T[3].shift());for(r=0;r<4;r++)for(n=0;n<4;n++)T[r][n]=o[T[r][n]];for(r=0;r<4;r++)for(n=0;n<4;n++)T[r][n]^=m[n][r];for(r=0;r<_._blocksize;r++)for(n=0;n<4;n++)t[e+4*n+r]=T[r][n]},_init:function(t){v=t.length/4,B=v+6,_._keyexpansion(t)},_keyexpansion:function(t){m=[];for(var e=0;e<v;e++)m[e]=[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]];for(e=v;e<_._blocksize*(B+1);e++){var r=[m[e-1][0],m[e-1][1],m[e-1][2],m[e-1][3]];e%v==0?(r.push(r.shift()),r[0]=n[r[0]],r[1]=n[r[1]],r[2]=n[r[2]],r[3]=n[r[3]],r[0]^=I[e/v]):v>6&&e%v==4&&(r[0]=n[r[0]],r[1]=n[r[1]],r[2]=n[r[2]],r[3]=n[r[3]]),m[e]=[m[e-v][0]^r[0],m[e-v][1]^r[1],m[e-v][2]^r[2],m[e-v][3]^r[3]]}}}}(),ECFieldElementFp.prototype.equals=feFpEquals,ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger,ECFieldElementFp.prototype.negate=feFpNegate,ECFieldElementFp.prototype.add=feFpAdd,ECFieldElementFp.prototype.subtract=feFpSubtract,ECFieldElementFp.prototype.multiply=feFpMultiply,ECFieldElementFp.prototype.square=feFpSquare,ECFieldElementFp.prototype.divide=feFpDivide,ECPointFp.prototype.getX=pointFpGetX,ECPointFp.prototype.getY=pointFpGetY,ECPointFp.prototype.equals=pointFpEquals,ECPointFp.prototype.isInfinity=pointFpIsInfinity,ECPointFp.prototype.negate=pointFpNegate,ECPointFp.prototype.add=pointFpAdd,ECPointFp.prototype.twice=pointFpTwice,ECPointFp.prototype.multiply=pointFpMultiply,ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo,ECCurveFp.prototype.getQ=curveFpGetQ,ECCurveFp.prototype.getA=curveFpGetA,ECCurveFp.prototype.getB=curveFpGetB,ECCurveFp.prototype.equals=curveFpEquals,ECCurveFp.prototype.getInfinity=curveFpGetInfinity,ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger,ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;var canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,r,n,o,s){for(;--s>=0;){var u=e*this[t++]+r[n]+o;o=Math.floor(u/67108864),r[n++]=67108863&u}return o}function am2(t,e,r,n,o,s){for(var u=32767&e,a=e>>15;--s>=0;){var h=32767&this[t],g=this[t++]>>15,l=a*h+g*u;o=((h=u*h+((32767&l)<<15)+r[n]+(1073741823&o))>>>30)+(l>>>15)+a*g+(o>>>30),r[n++]=1073741823&h}return o}function am3(t,e,r,n,o,s){for(var u=16383&e,a=e>>14;--s>=0;){var h=16383&this[t],g=this[t++]>>14,l=a*h+g*u;o=((h=u*h+((16383&l)<<14)+r[n]+o)>>28)+(l>>14)+a*g,r[n++]=268435455&h}return o}j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var rr,vv,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var r=BI_RC[t.charCodeAt(e)];return null==r?-1:r}function bnpCopyTo(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var u=8==r?255&t[n]:intAt(t,n);u<0?"-"==t.charAt(n)&&(o=!0):(o=!1,0==s?this[this.t++]=u:s+r>this.DB?(this[this.t-1]|=(u&(1<<this.DB-s)-1)<<s,this[this.t++]=u>>this.DB-s):this[this.t-1]|=u<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,o=!1,s="",u=this.t,a=this.DB-u*this.DB%e;if(u-- >0)for(a<this.DB&&(r=this[u]>>a)>0&&(o=!0,s=int2char(r));u>=0;)a<e?(r=(this[u]&(1<<a)-1)<<e-a,r|=this[--u]>>(a+=this.DB-e)):(r=this[u]>>(a-=e)&n,a<=0&&(a+=this.DB,--u)),r>0&&(o=!0),o&&(s+=int2char(r));return o?s:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0}function nbits(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var r,n=t%this.DB,o=this.DB-n,s=(1<<o)-1,u=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+u+1]=this[r]>>o|a,a=(this[r]&s)<<n;for(r=u-1;r>=0;--r)e[r]=0;e[u]=a,e.t=this.t+u+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var n=t%this.DB,o=this.DB-n,s=(1<<n)-1;e[0]=this[r]>>n;for(var u=r+1;u<this.t;++u)e[u-r-1]|=(this[u]&s)<<o,e[u-r]=this[u]>>n;n>0&&(e[this.t-r-1]|=(this.s&s)<<o),e.t=this.t-r,e.clamp()}}function bnpSubTo(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()}function bnpMultiplyTo(t,e){var r=this.abs(),n=t.abs(),o=r.t;for(e.t=o+n.t;--o>=0;)e[o]=0;for(o=0;o<n.t;++o)e[o+r.t]=r.am(0,n[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,r){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var s=nbi(),u=this.s,a=t.s,h=this.DB-nbits(n[n.t-1]);h>0?(n.lShiftTo(h,s),o.lShiftTo(h,r)):(n.copyTo(s),o.copyTo(r));var g=s.t,l=s[g-1];if(0!=l){var y=l*(1<<this.F1)+(g>1?s[g-2]>>this.F2:0),v=this.FV/y,B=(1<<this.F1)/y,m=1<<this.F2,I=r.t,T=I-g,_=null==e?nbi():e;for(s.dlShiftTo(T,_),r.compareTo(_)>=0&&(r[r.t++]=1,r.subTo(_,r)),BigInteger.ONE.dlShiftTo(g,_),_.subTo(s,s);s.t<g;)s[s.t++]=0;for(;--T>=0;){var O=r[--I]==l?this.DM:Math.floor(r[I]*v+(r[I-1]+m)*B);if((r[I]+=s.am(0,O,r,T,0,g))<O)for(s.dlShiftTo(T,_),r.subTo(_,r);r[I]<--O;)r.subTo(_,r)}null!=e&&(r.drShiftTo(g,e),u!=a&&BigInteger.ZERO.subTo(e,e)),r.t=g,r.clamp(),h>0&&r.rShiftTo(h,r),u<0&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(BigInteger.ZERO)>0&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(BigInteger.ZERO)>0&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,e){if(t>4294967295||t<1)return BigInteger.ONE;var r=nbi(),n=nbi(),o=e.convert(this),s=nbits(t)-1;for(o.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,o,r);else{var u=r;r=n,n=u}return e.revert(r)}function bnModPowInt(t,e){var r;return r=t<256||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,r)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=nbv(r),o=nbi(),s=nbi(),u="";for(this.divRemTo(n,o,s);o.signum()>0;)u=(r+s.intValue()).toString(t).substr(1)+u,o.divRemTo(n,o,s);return s.intValue().toString(t)+u}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),o=!1,s=0,u=0,a=0;a<t.length;++a){var h=intAt(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(o=!0):(u=e*u+h,++s>=r&&(this.dMultiply(n),this.dAddOffset(u,0),s=0,u=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(u,0)),o&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var n=new Array,o=7&t;n.length=1+(t>>3),e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}}function bnToByteArray(){var t=this.t,e=new Array;e[0]=this.s;var r,n=this.DB-t*this.DB%8,o=0;if(t-- >0)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[o++]=r|this.s<<this.DB-n);t>=0;)n<8?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==o&&(128&this.s)!=(128&r)&&++o,(o>0||r!=this.s)&&(e[o++]=r);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,e,r){var n,o,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(o=t.s&this.DM,n=s;n<this.t;++n)r[n]=e(this[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=s;n<t.t;++n)r[n]=e(o,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=cbit(this[r]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var r=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[r++]=n:n<-1&&(e[r++]=this.DV+n),e.t=r,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),r=nbi();return this.divRemTo(t,e,r),new Array(e,r)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,r){t.multiplyTo(e,r)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,r){var n,o=Math.min(this.t+t.t,e);for(r.s=0,r.t=o;o>0;)r[--o]=0;for(n=r.t-this.t;o<n;++o)r[o+this.t]=this.am(0,t[o],r,o,0,this.t);for(n=Math.min(t.t,e);o<n;++o)this.am(0,t[o],r,o,0,e-o);r.clamp()}function bnpMultiplyUpperTo(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnModPow(t,e){var r,n,o=t.bitLength(),s=nbv(1);if(o<=0)return s;r=o<18?1:o<48?3:o<144?4:o<768?5:6,n=o<8?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var u=new Array,a=3,h=r-1,g=(1<<r)-1;if(u[1]=n.convert(this),r>1){var l=nbi();for(n.sqrTo(u[1],l);a<=g;)u[a]=nbi(),n.mulTo(l,u[a-2],u[a]),a+=2}var y,v,B=t.t-1,m=!0,I=nbi();for(o=nbits(t[B])-1;B>=0;){for(o>=h?y=t[B]>>o-h&g:(y=(t[B]&(1<<o+1)-1)<<h-o,B>0&&(y|=t[B-1]>>this.DB+o-h)),a=r;0==(1&y);)y>>=1,--a;if((o-=a)<0&&(o+=this.DB,--B),m)u[y].copyTo(s),m=!1;else{for(;a>1;)n.sqrTo(s,I),n.sqrTo(I,s),a-=2;a>0?n.sqrTo(s,I):(v=s,s=I,I=v),n.mulTo(I,u[y],s)}for(;B>=0&&0==(t[B]&1<<o);)n.sqrTo(s,I),v=s,s=I,I=v,--o<0&&(o=this.DB-1,--B)}return n.revert(s)}function bnGCD(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var o=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(o<s&&(s=o),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function bnpModInt(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this[n])%t;return r}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var r=t.clone(),n=this.clone(),o=nbv(1),s=nbv(0),u=nbv(0),a=nbv(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?(u.isEven()&&a.isEven()||(u.addTo(this,u),a.subTo(t,a)),u.rShiftTo(1,u)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&o.subTo(u,o),s.subTo(a,s)):(n.subTo(r,n),e&&u.subTo(o,u),a.subTo(s,a))}return 0!=n.compareTo(BigInteger.ONE)?BigInteger.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(t){var e,r=this.abs();if(1==r.t&&r[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(r[0]==lowprimes[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<lowprimes.length;){for(var n=lowprimes[e],o=e+1;o<lowprimes.length&&n<lplim;)n*=lowprimes[o++];for(n=r.modInt(n);e<o;)if(n%lowprimes[e++]==0)return!1}return r.millerRabin(t)}function bnpMillerRabin(t){var e=this.subtract(BigInteger.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var n=e.shiftRight(r);(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length);for(var o=nbi(),s=0;s<t;++s){o.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var u=o.modPow(n,this);if(0!=u.compareTo(BigInteger.ONE)&&0!=u.compareTo(e)){for(var a=1;a++<r&&0!=u.compareTo(e);)if(0==(u=u.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=u.compareTo(e))return!1}}return!0}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(t){var e,r,n;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function ARC4next(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_state,rng_pool,rng_pptr,has_seeded_large_seed,rng_psize=256;function rng_seed_int(t,e){e||(e=32);for(var r=0;r<=e-8;r+=8)t>>r&&(rng_pool[rng_pptr++]^=t>>r&255),rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function seed_large_int32_array(t){if(t.length<rng_psize/4)throw"Seed shorter than rng_psize";for(var e=0;e<t.length;++e)rng_seed_int(t[e],32);has_seeded_large_seed=!0}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(null==rng_pool){rng_pool=new Array,rng_pptr=0,has_seeded_large_seed=!1;var mCrypto=_window.crypto||_window.msCrypto;if(mCrypto&&mCrypto.getRandomValues&&"undefined"!=typeof Int32Array){var word_array=new Int32Array(rng_psize/4);mCrypto.getRandomValues(word_array),seed_large_int32_array(word_array)}for(var ii=0;ii<rng_psize/2;++ii)rng_seed_int(65536*Math.random(),16)}function rng_get_byte(){if(null==rng_state){if(rng_pool.length!=rng_psize)throw"RNG Pool length does not match pool size";if(rng_pool.filter((function(t){return 0==Math.abs(t)})).length>12)throw"RNG Pool contains a large number of zero elements";if(!has_seeded_large_seed)throw"RNG Pool has not been seeded with sufficient entropy yet";for(rng_seed_time(),(rng_state=prng_newstate()).init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(t){var e;for(e=0;e<t.length;++e)t[e]=rng_get_byte()}function SecureRandom(){}function X9ECParameters(t,e,r,n){this.curve=t,this.g=e,this.n=r,this.h=n}function x9getCurve(){return this.curve}function x9getG(){return this.g}function x9getN(){return this.n}function x9getH(){return this.h}function fromHex(t){return new BigInteger(t,16)}function secp256k1(){var t=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),e=BigInteger.ZERO,r=fromHex("7"),n=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),o=BigInteger.ONE,s=new ECCurveFp(t,e,r),u=s.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new X9ECParameters(s,u,n,o)}SecureRandom.prototype.nextBytes=rng_get_bytes,X9ECParameters.prototype.getCurve=x9getCurve,X9ECParameters.prototype.getG=x9getG,X9ECParameters.prototype.getN=x9getN,X9ECParameters.prototype.getH=x9getH;var Bitcoin={};for(var i in BigInteger.valueOf=function(t){return t?new BigInteger(""+t,10):BigInteger.ZERO},BigInteger.prototype.toByteArrayUnsigned=function(){var t=this.abs().toByteArray();return t.length?(0==t[0]&&(t=t.slice(1)),t.map((function(t){return t<0?t+256:t}))):t},BigInteger.fromByteArrayUnsigned=function(t){return t.length?128&t[0]?new BigInteger([0].concat(t)):new BigInteger(t):t.valueOf(0)},BigInteger.prototype.toByteArraySigned=function(){var t=this.abs().toByteArrayUnsigned();return this.compareTo(BigInteger.ZERO)<0?128&t[0]?t.unshift(128):t[0]|=128:128&t[0]&&t.unshift(0),t},BigInteger.fromByteArraySigned=function(t){return 128&t[0]?(t[0]&=127,BigInteger.fromByteArrayUnsigned(t).negate()):BigInteger.fromByteArrayUnsigned(t)},Bitcoin.Util={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},makeFilledArray:function(t,e){for(var r=[],n=0;n<t;)r[n++]=e;return r},numToVarInt:function(t){return t<253?[t]:t<=65536?[253,255&t,t>>>8]:t<=1?[254].concat(Crypto.util.wordsToBytes([t])):[255].concat(Crypto.util.wordsToBytes([t>>>32,t]))},valueToBigInt:function(t){return t instanceof BigInteger?t:BigInteger.fromByteArrayUnsigned(t)},formatValue:function(t){for(var e=this.valueToBigInt(t).toString(),r=e.length>8?e.substr(0,e.length-8):"0",n=e.length>8?e.substr(e.length-8):e;n.length<8;)n="0"+n;for(n=n.replace(/0*$/,"");n.length<2;)n+="0";return r+"."+n},parseValue:function(t){if(!t)return BigInteger.ZERO;if(!/^[\d.]+$/.test(t=""+t))return BigInteger.ZERO;var e=t.split("."),r=e[0],n=e[1]||"0";for(n=n.length>8?n.substr(0,8):n;n.length<8;)n+="0";n=n.replace(/^0+/g,"");var o=BigInteger.valueOf(r);return o=(o=o.multiply(BigInteger.valueOf(1e8))).add(BigInteger.valueOf(n))},sha256ripe160:function(t){return Crypto.RIPEMD160(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})}},Crypto.util)Crypto.util.hasOwnProperty(i)&&(Bitcoin.Util[i]=Crypto.util[i]);var B58={alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",base:BigInteger.valueOf(58),encode:function(t){for(var e=BigInteger.fromByteArrayUnsigned(t),r=[];e.compareTo(B58.base)>=0;){var n=e.mod(B58.base);r.unshift(B58.alphabet[n.intValue()]),e=e.subtract(n).divide(B58.base)}r.unshift(B58.alphabet[e.intValue()]);for(var o=0;o<t.length&&0==t[o];o++)r.unshift(B58.alphabet[0]);return r.join("")},decode:function(t){for(var e=BigInteger.valueOf(0),r=0,n=t.length-1;n>=0;n--){var o=B58.alphabet.indexOf(t[n]);e=e.add(BigInteger.valueOf(o).multiply(B58.base.pow(t.length-1-n))),"1"==t[n]?r++:r=0}for(var s=e.toByteArrayUnsigned();r-- >0;)s.unshift(0);return s}};function deterministicGenerateK(t,e,r){if(32!=e.length)throw"Hash must be 256 bit";for(var p=function(t,e){for(var r=0;r<t.length;++r)t[r]=e},n=r.toByteArrayUnsigned(),o=[],s=32-n.length;o.length<s;)o.push(0);n=o.concat(n);var u=new Array(32),a=new Array(32),h=[0];p(a,1),p(u,0),u=Crypto.HMAC(Crypto.SHA256,a.concat(h,n,e),u,{asBytes:!0}),a=Crypto.HMAC(Crypto.SHA256,a,u,{asBytes:!0}),u=Crypto.HMAC(Crypto.SHA256,a.concat([1],n,e),u,{asBytes:!0}),a=Crypto.HMAC(Crypto.SHA256,a,u,{asBytes:!0}),a=Crypto.HMAC(Crypto.SHA256,a,u,{asBytes:!0});for(var g=BigInteger.fromByteArrayUnsigned(a);g.signum()<=0||g.compareTo(t)>=0;)u=Crypto.HMAC(Crypto.SHA256,a.concat(h),u,{asBytes:!0}),a=Crypto.HMAC(Crypto.SHA256,a,u,{asBytes:!0}),g=BigInteger.fromByteArrayUnsigned(a);return g}function integerToBytes(t,e){var r=t.toByteArrayUnsigned();if(e<r.length)r=r.slice(r.length-e);else for(;e>r.length;)r.unshift(0);return r}function dmp(t){return t instanceof BigInteger||(t=t.toBigInteger()),Crypto.util.bytesToHex(t.toByteArrayUnsigned())}Bitcoin.Base58=B58,Bitcoin.Address=function(t,e){"string"!=typeof t?(this.hash=t,this.version=e||Bitcoin.Address.pubKeyHashVersion):this.fromString(t)},Bitcoin.Address.prototype.toString=function(){var t=this.hash.slice(0);t.unshift(this.version);var e=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0}),r=t.concat(e.slice(0,4));return Bitcoin.Base58.encode(r)},Bitcoin.Address.prototype.getHashBase64=function(){return Crypto.util.bytesToBase64(this.hash)},Bitcoin.Address.prototype.fromString=function(t){var e=Bitcoin.Base58.decode(t),r=e.slice(0,21),n=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0});if(n[0]!=e[21]||n[1]!=e[22]||n[2]!=e[23]||n[3]!=e[24])throw"Checksum validation failed!";if(this.version=r.shift(),this.hash=r,this.version!=Bitcoin.Address.pubKeyHashVersion&&this.version!=Bitcoin.Address.p2shVersion)throw"Version "+version+" not supported!"},Bitcoin.Address.isP2SHAddress=function(){return this.version==Bitcoin.Address.p2shVersion},Bitcoin.Address.isPubKeyHashAddress=function(){return this.version==Bitcoin.Address.pubKeyHashVersion},Bitcoin.Address.pubKeyHashVersion=0,Bitcoin.Address.p2shVersion=5,ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(t){var e=this.getX().toBigInteger(),r=this.getY().toBigInteger(),n=integerToBytes(e,32);return t?r.isEven()?n.unshift(2):n.unshift(3):(n.unshift(4),n=n.concat(integerToBytes(r,32))),n},ECPointFp.decodeFrom=function(t,e){e[0];var r=e.length-1,n=e.slice(1,1+r/2),o=e.slice(1+r/2,1+r);n.unshift(0),o.unshift(0);var s=new BigInteger(n),u=new BigInteger(o);return new ECPointFp(t,t.fromBigInteger(s),t.fromBigInteger(u))},ECPointFp.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),r=t.y.subtract(this.y).divide(e),n=r.square().subtract(this.x).subtract(t.x),o=r.multiply(this.x.subtract(n)).subtract(this.y);return new ECPointFp(this.curve,n,o)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(BigInteger.valueOf(2)),e=this.curve.fromBigInteger(BigInteger.valueOf(3)),r=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),n=r.square().subtract(this.x.multiply(t)),o=r.multiply(this.x.subtract(n)).subtract(this.y);return new ECPointFp(this.curve,n,o)},ECPointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,r=t,n=r.multiply(new BigInteger("3")),o=this.negate(),s=this;for(e=n.bitLength()-2;e>0;--e){s=s.twice();var u=n.testBit(e);u!=r.testBit(e)&&(s=s.add2D(u?this:o))}return s},ECPointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),o=this.curve.getQ(),s=e.multiply(e).mod(o),u=t.multiply(t).multiply(t).add(r.multiply(t)).add(n).mod(o);return s.equals(u)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(e.compareTo(BigInteger.ONE)<0||e.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(BigInteger.ONE)<0||r.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},Bitcoin.ECDSA=function(){var t=secp256k1(),e=new SecureRandom,r=null;var n={getBigRandom:function(t){return new BigInteger(t.bitLength(),e).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},sign:function(e,r){var n=r,o=t.getN(),s=BigInteger.fromByteArrayUnsigned(e),u=deterministicGenerateK(o,e,n),a=t.getG().multiply(u).getX().toBigInteger().mod(o);if(0==a.signum())throw"Invalid R";var h=u.modInverse(o).multiply(s.add(n.multiply(a))).mod(o);if(0==h.signum())throw"Invalid S";var g=o.shiftRight(1);return h.compareTo(g)>0&&(h=o.subtract(h)),{r:a,s:h}},verify:function(e,r,o){var s,u,a;if(Bitcoin.Util.isArray(r)){var h=n.parseSig(r);s=h.r,u=h.s}else{if("object"!=typeof r||!r.r||!r.s)throw"Invalid value for signature";s=r.r,u=r.s}if(o instanceof ECPointFp)a=o;else{if(!Bitcoin.Util.isArray(o))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=ECPointFp.decodeFrom(t.getCurve(),o)}var g=BigInteger.fromByteArrayUnsigned(e);return n.verifyRaw(g,s,u,a)},verifyRaw:function(e,r,n,o){var s=t.getN(),u=t.getG();if(r.compareTo(BigInteger.ONE)<0||r.compareTo(s)>=0)return!1;if(n.compareTo(BigInteger.ONE)<0||n.compareTo(s)>=0)return!1;var a=n.modInverse(s),h=e.multiply(a).mod(s),g=r.multiply(a).mod(s);return u.multiply(h).add(o.multiply(g)).getX().toBigInteger().mod(s).equals(r)},serializeSig:function(t,e){var r=t.toByteArraySigned(),n=e.toByteArraySigned(),o=[];return o.push(2),o.push(r.length),(o=o.concat(r)).push(2),o.push(n.length),(o=o.concat(n)).unshift(o.length),o.unshift(48),o},parseSig:function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:BigInteger.fromByteArrayUnsigned(r),s:BigInteger.fromByteArrayUnsigned(n)}},parseSigCompact:function(e){if(65!==e.length)throw"Signature has the wrong length";var r=e[0]-27;if(r<0||r>7)throw"Invalid signature type";var n=t.getN();return{r:BigInteger.fromByteArrayUnsigned(e.slice(1,33)).mod(n),s:BigInteger.fromByteArrayUnsigned(e.slice(33,65)).mod(n),i:r}},recoverPubKey:function(e,o,s,u){var a=1&(u&=3),h=u>>1,g=t.getN(),l=t.getG(),y=t.getCurve(),v=y.getQ(),B=y.getA().toBigInteger(),m=y.getB().toBigInteger();r||(r=v.add(BigInteger.ONE).divide(BigInteger.valueOf(4)));var I=h?e.add(g):e,T=I.multiply(I).multiply(I).add(B.multiply(I)).add(m).mod(v).modPow(r,v),_=(T.isEven(),(T.isEven()?!a:a)?T:v.subtract(T)),O=new ECPointFp(y,y.fromBigInteger(I),y.fromBigInteger(_));O.validate();var P=BigInteger.fromByteArrayUnsigned(s),S=BigInteger.ZERO.subtract(P).mod(g),E=e.modInverse(g),A=function b(t,e,r,n){for(var o=Math.max(e.bitLength(),n.bitLength()),s=t.add2D(r),u=t.curve.getInfinity(),a=o-1;a>=0;--a)(u=u.twice2D()).z=BigInteger.ONE,e.testBit(a)?u=n.testBit(a)?u.add2D(s):u.add2D(t):n.testBit(a)&&(u=u.add2D(r));return u}(O,o,l,S).multiply(E);if(A.validate(),!n.verifyRaw(P,e,o,A))throw"Pubkey recovery unsuccessful";var F=new Bitcoin.ECKey;return F.pub=A,F},calcPubkeyRecoveryParam:function(t,e,r,n){for(var o=0;o<4;o++)try{if(Bitcoin.ECDSA.recoverPubKey(e,r,n,o).getBitcoinAddress().toString()==t)return o}catch(t){}throw"Unable to find valid recovery factor"}};return n}(),Bitcoin.ECKey=function(){var t=Bitcoin.ECDSA,e=secp256k1(),r=(new SecureRandom,function(n){if(n)n instanceof BigInteger?this.priv=n:Bitcoin.Util.isArray(n)?this.priv=BigInteger.fromByteArrayUnsigned(n):"string"==typeof n&&(51==n.length&&"5"==n[0]?this.priv=BigInteger.fromByteArrayUnsigned(r.decodeString(n)):this.priv=BigInteger.fromByteArrayUnsigned(Crypto.util.base64ToBytes(n)));else{var o=e.getN();this.priv=t.getBigRandom(o)}this.compressed=!!r.compressByDefault});return r.compressByDefault=!1,r.prototype.setCompressed=function(t){this.compressed=!!t},r.prototype.isCompressed=function(){return this.compressed},r.prototype.getPub=function(){return this.getPubPoint().getEncoded(this.compressed)},r.prototype.getPubPoint=function(){return this.pub||(this.pub=e.getG().multiply(this.priv)),this.pub},r.prototype.getPubKeyHash=function(){return this.pubKeyHash?this.pubKeyHash:this.pubKeyHash=Bitcoin.Util.sha256ripe160(this.getPub())},r.prototype.getBitcoinAddress=function(){var t=this.getPubKeyHash();return new Bitcoin.Address(t)},r.prototype.getPubCompressed=function(){return this.pubCompressed?this.pubCompressed:this.pubCompressed=this.getPubPoint().getEncoded(1)},r.prototype.getPubKeyHashCompressed=function(){return this.pubKeyHashCompressed?this.pubKeyHashCompressed:this.pubKeyHashCompressed=Bitcoin.Util.sha256ripe160(this.getPubCompressed())},r.prototype.getBitcoinAddressCompressed=function(){var t=this.getPubKeyHashCompressed();return new Bitcoin.Address(t)},r.prototype.setPub=function(t){this.pub=ECPointFp.decodeFrom(e.getCurve(),t)},r.prototype.toString=function(t){return"base64"===t?Crypto.util.bytesToBase64(this.priv.toByteArrayUnsigned()):Crypto.util.bytesToHex(this.priv.toByteArrayUnsigned())},r.prototype.sign=function(e){return t.sign(e,this.priv)},r.prototype.verify=function(e,r){return t.verify(e,r,this.getPub())},r}();var Opcode=Bitcoin.Opcode=function(t){this.code=t};for(var i in Opcode.prototype.toString=function(){return Opcode.reverseMap[this.code]},Opcode.map={OP_0:0,OP_FALSE:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_1:81,OP_TRUE:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},Opcode.reverseMap=[],Opcode.map)Opcode.reverseMap[Opcode.map[i]]=i;Bitcoin.ECKey=function(){var t=Bitcoin.ECDSA,e=secp256k1(),r=(new SecureRandom,function(n){if(n)n instanceof BigInteger?this.priv=n:Bitcoin.Util.isArray(n)?this.priv=BigInteger.fromByteArrayUnsigned(n):"string"==typeof n&&(51==n.length&&"5"==n[0]?this.priv=BigInteger.fromByteArrayUnsigned(r.decodeString(n)):this.priv=BigInteger.fromByteArrayUnsigned(Crypto.util.base64ToBytes(n)));else{var o=e.getN();this.priv=t.getBigRandom(o)}this.compressed=!!r.compressByDefault});return r.compressByDefault=!1,r.prototype.setCompressed=function(t){this.compressed=!!t},r.prototype.isCompressed=function(){return this.compressed},r.prototype.getPub=function(){return this.getPubPoint().getEncoded(this.compressed)},r.prototype.getPubPoint=function(){return this.pub||(this.pub=e.getG().multiply(this.priv)),this.pub},r.prototype.getPubKeyHash=function(){return this.pubKeyHash?this.pubKeyHash:this.pubKeyHash=Bitcoin.Util.sha256ripe160(this.getPub())},r.prototype.getBitcoinAddress=function(){var t=this.getPubKeyHash();return new Bitcoin.Address(t)},r.prototype.getPubCompressed=function(){return this.pubCompressed?this.pubCompressed:this.pubCompressed=this.getPubPoint().getEncoded(1)},r.prototype.getPubKeyHashCompressed=function(){return this.pubKeyHashCompressed?this.pubKeyHashCompressed:this.pubKeyHashCompressed=Bitcoin.Util.sha256ripe160(this.getPubCompressed())},r.prototype.getBitcoinAddressCompressed=function(){var t=this.getPubKeyHashCompressed();return new Bitcoin.Address(t)},r.prototype.setPub=function(t){this.pub=ECPointFp.decodeFrom(e.getCurve(),t)},r.prototype.toString=function(t){return"base64"===t?Crypto.util.bytesToBase64(this.priv.toByteArrayUnsigned()):Crypto.util.bytesToHex(this.priv.toByteArrayUnsigned())},r.prototype.sign=function(e){return t.sign(e,this.priv)},r.prototype.verify=function(e,r){return t.verify(e,r,this.getPub())},r}();var Script=Bitcoin.Script=function(t){if(t)if("string"==typeof t)this.buffer=Crypto.util.base64ToBytes(t);else if(Bitcoin.Util.isArray(t))this.buffer=t;else{if(!t.buffer)throw new Error("Invalid script");this.buffer=t.buffer}else this.buffer=[];this.parse()};Script.prototype.parse=function(){var t=this;this.chunks=[];var e=0;function c(r){t.chunks.push(t.buffer.slice(e,e+r)),e+=r}for(;e<this.buffer.length;){var r=this.buffer[e++];r>=240&&(r=r<<8|this.buffer[e++]),r>0&&r<Opcode.map.OP_PUSHDATA1?c(r):r==Opcode.map.OP_PUSHDATA1?c(this.buffer[e++]):r==Opcode.map.OP_PUSHDATA2?c(this.buffer[e++]<<8|this.buffer[e++]):r==Opcode.map.OP_PUSHDATA4?c(this.buffer[e++]<<24|this.buffer[e++]<<16|this.buffer[e++]<<8|this.buffer[e++]):this.chunks.push(r)}},Script.prototype.getOutType=function(){return 5==this.chunks.length&&this.chunks[0]==Opcode.map.OP_DUP&&this.chunks[1]==Opcode.map.OP_HASH160&&this.chunks[3]==Opcode.map.OP_EQUALVERIFY&&this.chunks[4]==Opcode.map.OP_CHECKSIG?"Address":2==this.chunks.length&&this.chunks[1]==Opcode.map.OP_CHECKSIG?"Pubkey":3==this.chunks.length&&this.chunks[0]==Opcode.map.OP_HASH160&&this.chunks[2]==Opcode.map.OP_EQUAL?"P2SH":this.chunks[this.chunks.length-1]==Opcode.map.OP_CHECKMULTISIG&&this.chunks[this.chunks.length-2]<=3?"Multisig":"Strange"},Script.prototype.simpleOutHash=function(){switch(this.getOutType()){case"Address":return this.chunks[2];case"Pubkey":return Bitcoin.Util.sha256ripe160(this.chunks[0]);case"P2SH":return this.chunks[1];default:throw new Error("Encountered non-standard scriptPubKey "+this.getOutType()+" Hex: "+Bitcoin.Util.bytesToHex(this.buffer))}},Script.prototype.simpleOutPubKeyHash=Script.prototype.simpleOutHash,Script.prototype.getInType=function(){return 1==this.chunks.length&&Bitcoin.Util.isArray(this.chunks[0])?"Pubkey":2==this.chunks.length&&Bitcoin.Util.isArray(this.chunks[0])&&Bitcoin.Util.isArray(this.chunks[1])?"Address":"Strange"},Script.prototype.simpleInPubKey=function(){switch(this.getInType()){case"Address":return this.chunks[1];case"Pubkey":throw new Error("Script does not contain pubkey.");default:throw new Error("Encountered non-standard scriptSig")}},Script.prototype.simpleInHash=function(){return Bitcoin.Util.sha256ripe160(this.simpleInPubKey())},Script.prototype.simpleInPubKeyHash=Script.prototype.simpleInHash,Script.prototype.writeOp=function(t){this.buffer.push(t),this.chunks.push(t)},Script.prototype.writeBytes=function(t){t.length<Opcode.map.OP_PUSHDATA1?this.buffer.push(t.length):t.length<=255?(this.buffer.push(Opcode.map.OP_PUSHDATA1),this.buffer.push(t.length)):t.length<=65535?(this.buffer.push(Opcode.map.OP_PUSHDATA2),this.buffer.push(255&t.length),this.buffer.push(t.length>>>8&255)):(this.buffer.push(Opcode.map.OP_PUSHDATA4),this.buffer.push(255&t.length),this.buffer.push(t.length>>>8&255),this.buffer.push(t.length>>>16&255),this.buffer.push(t.length>>>24&255)),this.buffer=this.buffer.concat(t),this.chunks.push(t)},Script.createOutputScript=function(t){var e=new Script;if(t.version==Bitcoin.Address.pubKeyHashVersion)return e.writeOp(Opcode.map.OP_DUP),e.writeOp(Opcode.map.OP_HASH160),e.writeBytes(t.hash),e.writeOp(Opcode.map.OP_EQUALVERIFY),e.writeOp(Opcode.map.OP_CHECKSIG),e;if(t.version==Bitcoin.Address.p2shVersion)return e.writeOp(Opcode.map.OP_HASH160),e.writeBytes(t.hash),e.writeOp(Opcode.map.OP_EQUAL),e;throw"Unknown address version"},Script.prototype.extractAddresses=function(t){switch(this.getOutType()){case"Address":return t.push(new Bitcoin.Address(this.chunks[2])),1;case"Pubkey":return t.push(new Bitcoin.Address(Bitcoin.Util.sha256ripe160(this.chunks[0]))),1;case"P2SH":return t.push(new Bitcoin.Address(this.chunks[1],Bitcoin.Address.p2shVersion)),1;case"Multisig":for(var e=1;e<this.chunks.length-2;++e)t.push(new Bitcoin.Address(Bitcoin.Util.sha256ripe160(this.chunks[e])));return this.chunks[0]-Opcode.map.OP_1+1;default:throw new Error("ExtractAddresses Encountered non-standard scriptPubKey "+this.getOutType()+" Hex: "+Bitcoin.Util.bytesToHex(this.serialize()))}},Script.createMultiSigOutputScript=function(t,e){var r=new Bitcoin.Script;r.writeOp(Opcode.map.OP_1+t-1);for(var n=0;n<e.length;++n)r.writeBytes(e[n]);return r.writeOp(Opcode.map.OP_1+e.length-1),r.writeOp(Opcode.map.OP_CHECKMULTISIG),r},Script.createPubKeyScript=function(t){var e=new Bitcoin.Script;return e.writeBytes(t),e.writeOp(Opcode.map.OP_CHECKSIG),e},Script.createInputScript=function(t,e){var r=new Script;return r.writeBytes(t),r.writeBytes(e),r},Script.prototype.clone=function(){return new Script(this.buffer)};var OP_CODESEPARATOR=171,SIGHASH_ALL=1,SIGHASH_NONE=2,SIGHASH_SINGLE=3,SIGHASH_ANYONECANPAY=80;!function(){var t=Bitcoin.Script,e=Bitcoin.Transaction=function(t){if(this.version=1,this.lock_time=0,this.ins=[],this.outs=[],this.timestamp=null,this.block=null,t){if(t.hash&&(this.hash=t.hash),t.version&&(this.version=t.version),t.lock_time&&(this.lock_time=t.lock_time),t.ins&&t.ins.length)for(var e=0;e<t.ins.length;e++)this.addInput(new r(t.ins[e]));if(t.outs&&t.outs.length)for(e=0;e<t.outs.length;e++)this.addOutput(new n(t.outs[e]));t.timestamp&&(this.timestamp=t.timestamp),t.block&&(this.block=t.block)}};e.objectify=function(t){for(var r=[],n=0;n<t.length;n++)r.push(new e(t[n]));return r},e.prototype.addInput=function(t,e){arguments[0]instanceof r?this.ins.push(arguments[0]):this.ins.push(new r({outpoint:{hash:t.hash,index:e},script:new Bitcoin.Script,sequence:4294967295}))},e.prototype.addOutput=function(e,r){if(arguments[0]instanceof n)this.outs.push(arguments[0]);else{if(r instanceof BigInteger)for(r=r.toByteArrayUnsigned().reverse();r.length<8;)r.push(0);else Bitcoin.Util.isArray(r);this.outs.push(new n({value:r,script:t.createOutputScript(e)}))}},e.prototype.serialize=function(){var t=[];t=(t=t.concat(Crypto.util.wordsToBytes([parseInt(this.version)]).reverse())).concat(Bitcoin.Util.numToVarInt(this.ins.length));for(var e=0;e<this.ins.length;e++){var r=this.ins[e];t=(t=t.concat(Crypto.util.base64ToBytes(r.outpoint.hash))).concat(Crypto.util.wordsToBytes([parseInt(r.outpoint.index)]).reverse());var n=r.script.buffer;t=(t=(t=t.concat(Bitcoin.Util.numToVarInt(n.length))).concat(n)).concat(Crypto.util.wordsToBytes([parseInt(r.sequence)]).reverse())}t=t.concat(Bitcoin.Util.numToVarInt(this.outs.length));for(e=0;e<this.outs.length;e++){var o=this.outs[e];t=t.concat(o.value);n=o.script.buffer;t=(t=t.concat(Bitcoin.Util.numToVarInt(n.length))).concat(n)}return t=t.concat(Crypto.util.wordsToBytes([parseInt(this.lock_time)]).reverse())},e.prototype.hashTransactionForSignature=function(e,r,n){for(var o=this.clone(),s=0;s<o.ins.length;s++)o.ins[s].script=new t;if(o.ins[r].script=e,(31&n)==SIGHASH_NONE){o.outs=[];for(s=0;s<o.ins.length;s++)s!=r&&(o.ins[s].sequence=0)}n&SIGHASH_ANYONECANPAY&&(o.ins=[o.ins[r]]);var u=o.serialize();u=u.concat(Crypto.util.wordsToBytes([parseInt(n)]).reverse());var a=Crypto.SHA256(u,{asBytes:!0});return Crypto.SHA256(a,{asBytes:!0})},e.prototype.getHash=function(){var t=this.serialize();return Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})},e.prototype.clone=function(){var t=new e;t.version=this.version,t.lock_time=this.lock_time;for(var r=0;r<this.ins.length;r++){var n=this.ins[r].clone();t.addInput(n)}for(r=0;r<this.outs.length;r++){var o=this.outs[r].clone();t.addOutput(o)}return t},e.prototype.addOutputScript=function(t,e){if(arguments[0]instanceof n)this.outs.push(arguments[0]);else{if(e instanceof BigInteger)for(e=e.toByteArrayUnsigned().reverse();e.length<8;)e.push(0);else Bitcoin.Util.isArray(e);this.outs.push(new n({value:e,script:t}))}},e.prototype.analyze=function(t){if(!(t instanceof Bitcoin.Wallet))return null;for(var e=!0,r=!0,n=null,o=null,s=null,u=this.outs.length-1;u>=0;u--){var a=this.outs[u].script.simpleOutPubKeyHash();t.hasHash(a)?o=a:r=!1,n=a}for(u=this.ins.length-1;u>=0;u--){if(s=this.ins[u].script.simpleInPubKeyHash(),!t.hasHash(s)){e=!1;break}}var h=this.calcImpact(t),g={};return g.impact=h,h.sign>0&&h.value.compareTo(BigInteger.ZERO)>0?(g.type="recv",g.addr=new Bitcoin.Address(o)):e&&r?g.type="self":e?(g.type="sent",g.addr=new Bitcoin.Address(n)):g.type="other",g},e.prototype.getDescription=function(t){var e=this.analyze(t);if(!e)return"";switch(e.type){case"recv":return"Received with "+e.addr;case"sent":return"Payment to "+e.addr;case"self":return"Payment to yourself";default:return""}},e.prototype.getTotalOutValue=function(){for(var t=BigInteger.ZERO,e=0;e<this.outs.length;e++){var r=this.outs[e];t=t.add(Bitcoin.Util.valueToBigInt(r.value))}return t},e.prototype.getTotalValue=e.prototype.getTotalOutValue,e.prototype.calcImpact=function(t){if(!(t instanceof Bitcoin.Wallet))return BigInteger.ZERO;for(var e=BigInteger.ZERO,r=0;r<this.outs.length;r++){var n=this.outs[r],o=Crypto.util.bytesToBase64(n.script.simpleOutPubKeyHash());t.hasHash(o)&&(e=e.add(Bitcoin.Util.valueToBigInt(n.value)))}var s=BigInteger.ZERO;for(r=0;r<this.ins.length;r++){var u=this.ins[r];o=Crypto.util.bytesToBase64(u.script.simpleInPubKeyHash());if(t.hasHash(o)){var a=t.txIndex[u.outpoint.hash];a&&(s=s.add(Bitcoin.Util.valueToBigInt(a.outs[u.outpoint.index].value)))}}return e.compareTo(s)>=0?{sign:1,value:e.subtract(s)}:{sign:-1,value:s.subtract(e)}};var r=Bitcoin.TransactionIn=function(e){this.outpoint=e.outpoint,e.script instanceof t?this.script=e.script:this.script=new t(e.script),this.sequence=e.sequence};r.prototype.clone=function(){return new r({outpoint:{hash:this.outpoint.hash,index:this.outpoint.index},script:this.script.clone(),sequence:this.sequence})};var n=Bitcoin.TransactionOut=function(e){if(e.script instanceof t?this.script=e.script:this.script=new t(e.script),Bitcoin.Util.isArray(e.value))this.value=e.value;else if("string"==typeof e.value){for(var r=new BigInteger(e.value,10).toString(16);r.length<16;)r="0"+r;this.value=Crypto.util.hexToBytes(r)}};n.prototype.clone=function(){return new n({script:this.script.clone(),value:this.value.slice(0)})}}(),Bitcoin.Message=function(){var t={magicPrefix:"Bitcoin Signed Message:\n",makeMagicMessage:function(e){var r=Crypto.charenc.UTF8.stringToBytes(t.magicPrefix),n=Crypto.charenc.UTF8.stringToBytes(e),o=[];return o=(o=(o=(o=o.concat(Bitcoin.Util.numToVarInt(r.length))).concat(r)).concat(Bitcoin.Util.numToVarInt(n.length))).concat(n)},getHash:function(e){var r=t.makeMagicMessage(e);return Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0})},signMessage:function(e,r,n){var o=t.getHash(r),s=e.sign(o),u=e.getBitcoinAddress().toString(),a=!(u==n),h=Bitcoin.ECDSA.calcPubkeyRecoveryParam(u,s.r,s.s,o);h+=27,a&&(h+=4);for(var g=s.r.toByteArrayUnsigned(),l=s.s.toByteArrayUnsigned();g.length<32;)g.unshift(0);for(;l.length<32;)l.unshift(0);var y=[h].concat(g).concat(l);return Crypto.util.bytesToBase64(y)},verifyMessage:function(e,r,n){r=Crypto.util.base64ToBytes(r),r=Bitcoin.ECDSA.parseSigCompact(r);var o=t.getHash(n),s=!!(4&r.i),u=Bitcoin.ECDSA.recoverPubKey(r.r,r.s,o,r.i);return u.setCompressed(s),u.getBitcoinAddress().toString()==e||u.getBitcoinAddressCompressed().toString()==e}};return t}();