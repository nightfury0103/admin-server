"use strict";(self.webpackChunkblockchain_wallet_v4_frontend=self.webpackChunkblockchain_wallet_v4_frontend||[]).push([[2922],{"./src/modals/Lockbox/components/AppManager/index.js":(e,t,n)=>{n.d(t,{Z:()=>X});var r,o,a,i,p,c,l,s,u,f=n("../../node_modules/react/index.js"),d=n("./node_modules/react-intl/lib/src/components/message.js"),g=n("../../node_modules/react-redux/es/index.js"),m=n("../../node_modules/prop-types/index.js"),y=n.n(m),h=n("../../node_modules/redux/es/redux.js"),x=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_=n("../blockchain-wallet-v4/src/index.ts"),b=n("../blockchain-info-components/src/index.js"),A=n("./src/data/index.ts"),v=n("./src/services/lockbox/index.js"),w=n("../../node_modules/ramda/es/prop.js"),P=n("../../node_modules/ramda/es/equals.js");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var k=x.ZP.div(r||(r=_taggedTemplateLiteral(["\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 4px;\n  margin: 6px 0;\n"]))),M=x.ZP.div(o||(o=_taggedTemplateLiteral(["\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: start;\n  justify-items: center;\n  & > :last-child {\n    margin-left: 15px;\n  }\n"]))),E=x.ZP.div(a||(a=_taggedTemplateLiteral(["\n  width: 100%;\n  display: flex;\n  flex-grow: 2;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  & > :last-child {\n    margin-left: 10px;\n  }\n"]))),O=x.ZP.div(i||(i=_taggedTemplateLiteral(["\n  padding: 5px;\n  border-radius: 3px;\n  background-color: ",";\n"])),(function(e){return e.theme[e.coin]})),C=(0,x.ZP)(b.zx)(p||(p=_taggedTemplateLiteral(["\n  border-radius: 20px;\n  height: 40px;\n  width: 40px;\n  &:hover {\n    background-color: ",";\n  }\n"])),(function(e){return!e.disabled&&e.theme.blue000})),T=(0,x.ZP)(b.zx)(c||(c=_taggedTemplateLiteral(["\n  border-radius: 100px;\n  height: 40px;\n  width: 30px;\n  max-width: 30px;\n"]))),S=(0,x.ZP)(b.JO)(l||(l=_taggedTemplateLiteral(["\n  margin-right: 6px;\n"]))),j=(0,x.ZP)(b.jL)(s||(s=_taggedTemplateLiteral(["\n  width: 38px;\n  height: 10px;\n  padding: 4px;\n  margin: -2px 0 0 5px;\n  background: none;\n  border: 1px solid #3558a8;\n  border-radius: 6px;\n  & > :first-child {\n    font-size: 8px;\n    color: #3558a8;\n  }\n"]))),L=x.ZP.div(u||(u=_taggedTemplateLiteral(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: 5px;\n"]))),Z=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(CoinActions,e);var t=_createSuper(CoinActions);function CoinActions(){return _classCallCheck(this,CoinActions),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(CoinActions,[{key:"render",value:function render(){var e=this.props,t=e.coinState,n=e.disableUpdates,r=e.installApp,o=e.uninstallApp;switch((0,w.Z)("status",t)){case"Updating":return f.createElement(E,null,f.createElement(b.JA,{style:{marginRight:"8px"},height:"36px",width:"36px"}));case"Error":return f.createElement(E,null,f.createElement(b.xv,{size:"11px",weight:500},t.error),f.createElement(S,{name:"alert-filled",color:"error",size:"40px"}));case"Success":return f.createElement(E,null,f.createElement(S,{color:"bch",name:"checkmark-in-circle-filled",size:"40px"}));default:return f.createElement(E,null,f.createElement(C,{nature:"empty-secondary",width:"80px",onClick:n?void 0:r,disabled:n},f.createElement(d.Z,{id:"components.lockbox.appmanager.install",defaultMessage:"Install"})),f.createElement(T,{nature:"empty",width:"50px",onClick:n?void 0:o,disabled:n},f.createElement(b.JO,{name:"trash",size:"18px"})))}}}]),CoinActions}(f.PureComponent);const z=function LockboxAppManager(e){var t=e.app,n=e.coin,r=e.coinState,o=e.disableUpdates,a=e.installApp,i=e.requireBtc,p=e.uninstallApp,c=t.name,l=t.version,s=n.toLowerCase();return f.createElement(k,null,f.createElement(M,null,f.createElement(O,{coin:s},f.createElement(b.JO,{size:"34px",color:"white",name:"".concat(s)})),f.createElement("div",null,f.createElement(L,null,f.createElement(b.xv,{size:"14px",weight:500,color:"grey700"},c),(0,P.Z)("btc",s)&&i&&f.createElement(j,{label:"true",type:"informational",style:{margin:"4px 0"}},f.createElement(d.Z,{id:"components.lockbox.appmanager.required",defaultMessage:"Required"}))),f.createElement(b.xv,{size:"11px",weight:400},(0,P.Z)("Updating",(0,w.Z)("status",r))?f.createElement(d.Z,{id:"components.lockbox.appmanager.changeType",defaultMessage:"{changeType}...",values:{changeType:r.changeType}}):f.createElement(d.Z,{id:"components.lockbox.appmanager.successmsg",defaultMessage:"Version {version}",values:{version:l}})))),f.createElement(Z,{coinState:r,disableUpdates:o,installApp:a,uninstallApp:p}))};function AppManager_typeof(e){return AppManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AppManager_typeof(e)}var R,I,N,U,D,B,q;function AppManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AppManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AppManager_setPrototypeOf(e,t){return AppManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},AppManager_setPrototypeOf(e,t)}function AppManager_createSuper(e){var t=function AppManager_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=AppManager_getPrototypeOf(e);if(t){var o=AppManager_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AppManager_possibleConstructorReturn(this,n)}}function AppManager_possibleConstructorReturn(e,t){if(t&&("object"===AppManager_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return AppManager_assertThisInitialized(e)}function AppManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AppManager_getPrototypeOf(e){return AppManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},AppManager_getPrototypeOf(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AppManager_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var F=x.ZP.div(R||(R=AppManager_taggedTemplateLiteral(["\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]))),G=x.ZP.div(I||(I=AppManager_taggedTemplateLiteral(["\n  text-align: center;\n  & > :last-child {\n    margin: 10px 0;\n  }\n"]))),V=(0,x.ZP)(b.T_)(N||(N=AppManager_taggedTemplateLiteral(["\n  margin: 20px;\n"]))),J=(0,x.ZP)(b.zx)(U||(U=AppManager_taggedTemplateLiteral(["\n  margin-top: 12px;\n"]))),W=(0,x.ZP)(b.xv)(D||(D=AppManager_taggedTemplateLiteral(["\n  text-align: center;\n  padding: 5px;\n  margin: 30px 0 36px;\n"]))),H=(0,x.ZP)(b.xv)(B||(B=AppManager_taggedTemplateLiteral(["\n  margin: 20px 0;\n  text-align: center;\n"]))),K=(0,x.ZP)(b.xv)(q||(q=AppManager_taggedTemplateLiteral(["\n  margin-top: 8px;\n  text-align: center;\n"]))),Q=function(e){!function AppManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AppManager_setPrototypeOf(e,t)}(LockboxAppManagerContainer,e);var t=AppManager_createSuper(LockboxAppManagerContainer);function LockboxAppManagerContainer(){var e;AppManager_classCallCheck(this,LockboxAppManagerContainer);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return _defineProperty(AppManager_assertThisInitialized(e=t.call.apply(t,[this].concat(r))),"state",{}),_defineProperty(AppManager_assertThisInitialized(e),"onAppInstall",(function(t,n){e.setState(_defineProperty({},t,{appName:t,changeType:"Installing",status:"Updating"})),e.props.lockboxActions.installApplication(n)})),_defineProperty(AppManager_assertThisInitialized(e),"onAppUninstall",(function(t){e.setState(_defineProperty({},t,{appName:t,changeType:"Uninstalling",status:"Updating"})),e.props.lockboxActions.uninstallApplication(t)})),e}return function AppManager_createClass(e,t,n){return t&&AppManager_defineProperties(e.prototype,t),n&&AppManager_defineProperties(e,n),e}(LockboxAppManagerContainer,[{key:"componentDidMount",value:function componentDidMount(){this.props.lockboxActions.initializeAppManager(this.props.deviceIndex)}},{key:"componentDidUpdate",value:function componentDidUpdate(e){var t=this;this.props.appChangeStatus!==e.appChangeStatus&&this.props.appChangeStatus.cata({Failure:function Failure(e){var n=v._G.supportedApps[e.appName]?v._G.supportedApps[e.appName]:e.appName;t.props.lockboxActions.resetAppChangeStatus(),t.setState(_defineProperty({},n,{error:e.error,status:"Error"})),setTimeout((function(){t.setState(_defineProperty({},n,{changeType:"",status:null}))}),1e4)},Loading:function Loading(){},NotAsked:function NotAsked(){},Success:function Success(e){var n=v._G.supportedApps[e.appName]?v._G.supportedApps[e.appName]:e.appName;t.props.lockboxActions.resetAppChangeStatus(),t.setState(_defineProperty({},n,{changeType:"",status:"Success"})),setTimeout((function(){t.setState(_defineProperty({},n,{status:null}))}),5e3)}})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.lockboxActions.resetAppChangeStatus()}},{key:"render",value:function render(){var e=this,t=this.props,n=t.appChangeStatus,r=t.appVersionInfos,o=t.connection,a=!_.Nt.NotAsked.is(n),i=r.cata({Failure:function Failure(){return f.createElement(b.xv,{size:"16px",weight:400},f.createElement(d.Z,{id:"components.lockbox.appmanager.appfailure",defaultMessage:"Failed to load application list. Please try again later."}))},Loading:function Loading(){return f.createElement(F,null,f.createElement(V,{style:{margin:"32px"},width:"75px",height:"75px"}))},NotAsked:function NotAsked(){return f.createElement(F,null,f.createElement(V,{style:{margin:"32px"},width:"75px",height:"75px"}))},Success:function Success(t){var n=t.map((function(t){var n=t.name,r=function getKeyByValue(e){return Object.keys(v._G.supportedApps).find((function(t){return v._G.supportedApps[t]===e}))}(n);return f.createElement(z,{key:n,app:t,coin:r,installApp:function installApp(){e.onAppInstall(n,r)},uninstallApp:function uninstallApp(){e.onAppUninstall(n)},coinState:e.state[n],disableUpdates:a,requireBtc:e.props.newDevice})}));return f.createElement(f.Fragment,null,n,f.createElement(H,{size:"11px",weight:400},f.createElement(d.Z,{id:"components.lockbox.appmanager.prompt",defaultMessage:'If prompted, be sure to allow the "Device Manager" onto the device during app updates.'})),e.props.newDevice&&f.createElement(K,{size:"10px",weight:400},f.createElement(d.Z,{id:"components.lockbox.appmanager.btcrequired",defaultMessage:"The Bitcoin app is needed to connect your Lockbox to your wallet."})),f.createElement(J,{disabled:a,onClick:e.props.onClose,nature:"primary",fullwidth:!0},e.props.mainButtonText))}});return f.createElement(F,null,"DASHBOARD"!==o.app?f.createElement(G,null,f.createElement(b.Ee,{width:"100%",name:"lockbox-onboard-connect"}),f.createElement(W,{size:"14px",weight:400},f.createElement(d.Z,{id:"components.lockbox.appmanager.connectdevice",defaultMessage:"Connect, unlock and open the Dashboard on your Lockbox device now."})),f.createElement(J,{disabled:!0,nature:"primary",fullwidth:!0},f.createElement(d.Z,{id:"components.lockbox.appmanager.waiting",defaultMessage:"Waiting..."}))):i)}}]),LockboxAppManagerContainer}(f.PureComponent);Q.propTypes={deviceIndex:y().string,mainButtonText:y().element.isRequired,newDevice:y().bool,onClose:y().func.isRequired};const X=(0,g.connect)((function mapStateToProps(e){return{appChangeStatus:A.wl.wx.T1.getAppChangeStatus(e),appVersionInfos:A.wl.wx.T1.getLatestApplicationVersions(e),connection:A.wl.wx.T1.getCurrentConnection(e)}}),(function mapDispatchToProps(e){return{lockboxActions:(0,h.bindActionCreators)(A.Nw.wx.lockbox,e)}}))(Q)}}]);